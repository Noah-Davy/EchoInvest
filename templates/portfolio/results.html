{% extends "portfolio/base.html" %}

{% block title %}Results{% endblock %}

{% block content %}
<h2>Investment Results</h2>
<p><strong>Risk Score:</strong> {{ risk_score }}</p>
<p><strong>Risk Tolerance:</strong> {{ risk_tolerance }}</p>

<h3>Allocated Portfolio</h3>
<p><strong>Total Investment:</strong> ${{ allocated_portfolio.total_investment }}</p>
{% for asset_class in allocated_portfolio.asset_classes %}
    <div>
        <h4>{{ asset_class.name|capfirst }}</h4>
        <p><strong>Allocation:</strong> ${{ asset_class.allocation }}</p>
        <p><strong>Percentage:</strong> {{ asset_class.percentage }}%</p>
        <ul>
            {% for stock in asset_class.stocks %}
            <li>{{ stock.name }} ({{ stock.symbol }}): ${{ stock.allocation }} ({{ stock.shares }} shares at ${{ stock.price }})</li>
            {% endfor %}
        </ul>
    </div>
{% endfor %}

<h3>Region Allocation</h3>
<ul>
    {% for region, percentage in allocated_portfolio.region_allocation.items %}
    <li>{{ region }}: {{ percentage|floatformat:2 }}%</li>
    {% endfor %}
</ul>

<h3>Sector Allocation</h3>
<ul>
    {% for sector, percentage in allocated_portfolio.sector_allocation.items %}
    <li>{{ sector }}: {{ percentage|floatformat:2 }}%</li>
    {% endfor %}
</ul>

<h3>Portfolio Performance (Last 10 Years)</h3>
<p>Date | Portfolio Value | SPY Value</p>
<ul>
    {% for performance in portfolio_performance %}
    <li>{{ performance.date }}: ${{ performance.portfolio_value }} | ${{ performance.spy_value }}</li>
    {% endfor %}
</ul>

<!-- Include Graphs -->
<div>
    <h3>Portfolio Allocation Graphs</h3>
    <div>
        <img src="{% static 'region_allocation.png' %}" alt="Region Allocation Pie Chart">
    </div>
    <div>
        <img src="{% static 'sector_allocation.png' %}" alt="Sector Allocation Pie Chart">
    </div>
</div>
{% endblock %}
